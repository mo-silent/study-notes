# 前言

## 什么是 ACK

ACK 是阿里云容器服务 Kubernetes的简称，阿里云用户可以创建ACK 专有集群和ACK 托管集群。ACK 专有集群与ACK托管集群最大的区别在于用户是否需要管理Kubernetes 集群的控制层面。在企业中，会普遍使用ACK托管集群来减少运维控制层面的成本。

**ACK专有集群和ACK托管集群对比**

![comparison](D:\study-notes\Alicloud\ACK\image\托管集群和专有集群对比.png)

## 为什么使用 SLS

一般云企业都会使用ACK托管集群，意味着控制层面的组件会被阿里云托管，用户不可见。托管的组件包括Kube-apiserver、kube-controller-manager、ack-scheduler和etcd。

虽然企业选择了ACK托管集群，但是在ACK 运维的过程中，这些组件的日志也是至关重要。运维人员能够通过托管组件日志，分析定位出具体问题所在。

**问题来了，组件是托管的，如何去采集日志？分析日志？**

在自建的Kubernetes 集群中，运维人员一般借助Loki，Logstash，fluntd，fluntbit 等开源组件来采集日志。在阿里云托管ACK 集群中，这些开源组件只能采集数据层面的数据，也就是在节点上运行的deployment, statefulset, pod 等等运行日志。

如果想要采集控制层面日志，则需要借助阿里云SLS，即日志服务。但如果控制层面使用SLS，而数据层面使用其他组件采集日志，日志采集就会存在两套方案。所以在阿里云ACK 中，集成了SLS采集数据层面日志的组件Logtail，该组件能够采集数据层面日志并推送到SLS日志中。这样日志采集系统就只有一套，运维成本会降低。

**如果多云环境下，SLS只能用于阿里云，那么IDC(自建)或其他云厂商的集群日志怎么办？**

很明显SLS的日志方案与阿里云高度耦合，不适用于IDC或其他云厂商。这个问题的日志方案会在另一个博客介绍。

# ACK 日志采集方案

## 架构



